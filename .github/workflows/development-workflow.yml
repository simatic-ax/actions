# This workflow is going to be used during the development phase of the image
# The workflow builds and tests the the sources on the following triggers:
#   - once a change is pushed to the main branch or any of its sub-branches
name: Development Workflow

on:
  push:
    branches:
      - 'main'
      - 'main/**'
  pull_request:
    branches:
      - 'main'
      - 'main/**'

jobs:
  build:
    name: Build
    runs-on: ubuntu-24.04
    container:
      image: ghcr.io/simatic-ax/ci-images/apax-ci-image:3.4.2
    steps:
      
      - name: Checkout Code
        uses: actions/checkout@v4

      # Checks out a repository for exemplatory purposes only
      # Once incorporated into your project, the "Checkout repo under test" step should be removed completely
      - name: Checkout repo under test
        uses: actions/checkout@v4
        with:
          repository: simatic-ax/actions-test
          token: ${{ secrets.CLONE_REPO_TOKEN }}
          path: 'actions-test'
          ref: 'main'

      - name: Build source code
        uses: ./build
        with:
          APAX_TOKEN: ${{ secrets.APAX_TOKEN }}